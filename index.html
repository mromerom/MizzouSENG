<!DOCTYPE html>
<html>
<head>
    <title>Presidential Primary Data 2016</title>
    <link href="app.css" rel="stylesheet" type="text/css">
    <script src="jquery-1.12.0.min.js"></script>
    <script src="d3.v3.min.js"></script>
</head>
<body>
    
    <div id="wrapper">
        <div id="graph1">
            <h2>2016 National Republican Primary</h2>
        </div>
        <hr>
        <div id="graph2">
            <h2>2016 National Democratic Primary</h2>
        </div>
        <hr>
        <div id="graph3">
            <h2>2016 Missouri President: Trump vs. Clinton</h2>
        </div>        
    </div>
    <script>
        
        var url1 = "http://elections.huffingtonpost.com/pollster/api/charts/2016-national-gop-primary";
        var url2 = "http://elections.huffingtonpost.com/pollster/api/charts/2016-national-democratic-primary";
        var url3 = "http://elections.huffingtonpost.com/pollster/api/charts/2016-missouri-president-trump-vs-clinton";

        function generateGrpah(id,data)
            {
            var candidateBar = d3.select("#"+id).selectAll("div").data(data.estimates),
                candidateWrapper = candidateBar.enter().append("div").classed("group", true);
            
            candidateWrapper.append("div")
                .classed("choice", true)
                .text(function(candidate) {
                    return candidate.choice + " " + parseFloat(Math.round(candidate.value * 100) / 100).toFixed(2) + "%";
                });
            
            candidateWrapper.append("div")
                .classed("bar", true)
                .transition()
                .duration(1000)
                .style("width", function(candidate) {
                    return candidate.value * 10 + "px";
                });
            }
        $(document).ready(function() {
            $.ajax(url1, {
                dataType: "jsonp",
                jsonpCallback: "pollsterCallback",
                cache: true,
                success: function(data1) {
                    generateGrpah("graph1",data1);
                }
            });
            $.ajax(url2, {
                dataType: "jsonp",
                jsonpCallback: "pollsterCallback",
                cache: true,
                success: function(data2) {
                    generateGrpah("graph2",data2);
                }
            });
            $.ajax(url3, {
                dataType: "jsonp",
                jsonpCallback: "pollsterCallback",
                cache: true,
                success: function(data3) {
                    generateGrpah("graph3",data3);
                }
            });             
        });

    </script>
</body>
</html>